# Instructions

- Following Playwright test failed.
- Explain why, be concise, respect Playwright best practices.
- Provide a snippet of code with the fix, if possible.

# Test info

- Name: Reopen tickets >> Reopen ticket to change technician and split tip
- Location: /home/circleci/project/e2e/pos-web/dist/bdd/reopen-ticket.feature.spec.js:86:3

# Error details

```
Error: locator.click: Test timeout of 90000ms exceeded.
Call log:
  - waiting for locator('li.xNavbar__item').filter({ hasText: /^Clock In$/ })
    - locator resolved to <li class="MuiListItem-root MuiListItem-gutters MuiListItem-padding xNavbar__item p6 css-czmr9k">â€¦</li>
  - attempting click action
    - waiting for element to be visible, enabled and stable
    - element is visible, enabled and stable
    - scrolling into view if needed
    - done scrolling
  - element was detached from the DOM, retrying

    at HomePage.selectNavItem (/home/circleci/project/e2e/pos-web/src/steps/x.page.ts:214:36)
    at HomePage.clockInTimesheet (/home/circleci/project/e2e/pos-web/src/steps/x.page.ts:271:3)
    at /home/circleci/project/node_modules/.pnpm/playwright-bdd@8.2.1_@cucumber+message-streams@4.0.1_@cucumber+messages@27.0.2__@playwright+test@1.51.1/node_modules/playwright-bdd/src/runtime/bddStepInvoker.ts:57:22
    at BddStepInvoker.invoke (/home/circleci/project/node_modules/.pnpm/playwright-bdd@8.2.1_@cucumber+message-streams@4.0.1_@cucumber+messages@27.0.2__@playwright+test@1.51.1/node_modules/playwright-bdd/src/runtime/bddStepInvoker.ts:51:5)
    at /home/circleci/project/e2e/pos-web/dist/bdd/reopen-ticket.feature.spec.js:88:5
```

# Page snapshot

```yaml
- banner:
  - img
  - list:
    - listitem: Timesheet
    - listitem: Check In
    - listitem: Tickets
    - listitem: Turn
    - listitem: Appointment
    - listitem: Quick Sale
    - listitem: Balance
  - text: Mar 27
  - list:
    - listitem: BLANC NAILS
    - listitem:
      - paragraph: ", , | (707) 707-1122"
      - text: "Thuyen Nguyen | Station: 1"
- list
- main:
  - text: CHECK-INS No Customer
  - tablist:
    - tab "NAILS" [selected]
    - tab "HAIR"
  - tabpanel:
    - list:
      - listitem:
        - img "item service Emily"
        - text: "#1 Emily 07:00 AM Turn: 0.0"
      - listitem: "T #2 Tom 07:00 AM Turn: 0.0"
      - listitem: "S #3 Sandy 07:00 AM Turn: 0.0"
      - listitem: "B #4 Bella 07:00 AM Turn: 0.0"
      - listitem: "D #5 Daisy 12:23 AM Turn: 0.0"
      - listitem: "D #6 Daniel 12:21 AM Turn: 0.0"
      - listitem: "M #7 Maya 07:00 AM Turn: 0.0"
      - listitem: "R #8 Ruby 07:00 AM Turn: 0.0"
      - listitem: "A #9 Angie 12:20 AM Turn: 0.0"
      - listitem: "H #10 Hanna 07:00 AM Turn: 0.0"
      - listitem: "B #11 Brian 07:00 AM Turn: 0.0"
      - listitem:
        - img "item service Owner"
        - text: "#12 Owner 12:12 AM Turn: 0.0"
      - listitem: "S #13 Samantha 12:21 AM Turn: 0.0"
      - listitem: "L #14 Laura 07:00 AM Turn: 0.0"
      - listitem:
        - img "item service Emma"
        - text: "#15 Emma 07:00 AM Turn: 0.0"
      - listitem: "T #16 Tim 07:00 AM Turn: 0.0"
      - listitem: "J #17 Jack 07:00 AM Turn: 0.0"
      - listitem: "D #18 Dylan 07:00 AM Turn: 0.0"
      - listitem: "H #19 Harry 07:00 AM Turn: 1.0"
      - listitem: "E #20 Evelyn 12:23 AM Turn: 1.0"
      - listitem: "T #21 Tina 07:00 AM Turn: 1.0"
      - listitem: "C #22 Christ 07:00 AM Turn: 1.0"
      - listitem: "L #23 Lisa 07:00 AM Turn: 1.0"
      - listitem: "J #24 Julia 12:21 AM Turn: 1.0"
      - listitem: "C #25 Chloe 12:19 AM Turn: 1.0"
      - listitem: "S #26 Sam 07:00 AM Turn: 1.0"
      - listitem: "K #27 Kelley 07:00 AM Turn: 1.0"
      - listitem: "K #28 Kim 07:00 AM Turn: 2.0"
      - listitem: "S #29 Sophia 07:00 AM Turn: 2.0"
      - listitem: "A #30 Anna 07:00 AM Turn: 7.0"
      - listitem: "E #31 Ethan 07:00 AM Turn: 8.0"
      - listitem: "M #32 Mia 12:17 AM Turn: 12.0"
  - button "search"
  - list:
    - listitem:
      - button "Ready"
    - listitem:
      - button "In Service"
    - listitem:
      - button "Paid"
    - listitem:
      - button "All" [disabled]
  - list:
    - listitem: "C Paid #147 Chloe Riley 07:03 PM - Now 0' Waiting $0.00"
    - listitem: "S In Service #157 Sarah 12:32 AM - Now -5' Manicure $6.00"
    - listitem: "A #158 Angie 12:32 AM - Now 0' Waiting $0.00"
    - listitem: "M #159 Mia 12:34 AM - Now 0' Waiting $0.00"
    - listitem: "M #160 Maya 12:34 AM - Now 0' Waiting $0.00"
    - listitem: "L #161 Lisa 12:34 AM - Now 0' Waiting $0.00"
    - listitem: "H #162 Harry 12:34 AM - Now 0' Waiting $0.00"
    - listitem: "B #169 Bella 12:34 AM - Now 0' Waiting $0.00"
    - listitem: "K #170 Kim 12:34 AM - Now 0' Waiting $0.00"
    - listitem: "S #171 Sophia 12:34 AM - Now 0' Waiting $0.00"
    - listitem: "B #172 Bella 12:36 AM - Now 0' Waiting $0.00"
    - listitem: "L #173 Lisa 12:36 AM - Now 0' Waiting $0.00"
    - listitem: "K #174 Kim 12:36 AM - Now 0' Waiting $0.00"
    - listitem: "H #175 Harry 12:36 AM - Now 0' Waiting $0.00"
    - listitem: "C Paid #190 Chloe Riley 07:03 PM - Now 0' Waiting $0.00"
    - listitem: "E Paid #202 Ethan Bill 07:03 PM - Now 0' Waiting $0.00"
    - listitem: "B Paid #206 Brian 12:57 AM - 12:57 AM 0' Waiting $19.84"
    - listitem: "K Paid #207 Kim 12:57 AM - 12:57 AM 0' Waiting $42.40"
- alert
```

# Test source

```ts
  114 | 			 * Some pages don't have this element
  115 | 			 */
  116 | 			pageName: pageHeader.locator('p.pageName'),
  117 | 			/**
  118 | 			 * Locate the page detail section of the current page, usually appears below the page name, ex: "John Doe - #001" (Ticket View page).
  119 | 			 * Some pages don't have this element
  120 | 			 */
  121 | 			pageDetail: pageHeader.locator('p.pageDetail'),
  122 |
  123 | 			/**
  124 | 			 * Locate the Company Profile section of the current Salon + the Breadcrumb element,
  125 | 			 * 	which is usually located on the top right corner of the page, next to the Calendar element
  126 | 			 */
  127 | 			companyProfile,
  128 | 			/**
  129 | 			 * Like the {@link companyProfile} locator, except it doesn't include the Breadcrumb element
  130 | 			 */
  131 | 			merchantInfo,
  132 | 			/**
  133 | 			 * Locate the name of the Salon on the top right corner of the page
  134 | 			 */
  135 | 			merchantName: merchantInfo.locator(
  136 | 				'li.merchantInfo__dbaName > span.label',
  137 | 			),
  138 | 			/**
  139 | 			 * Locate the contact information (address, phone number,...) on the top right corner of the page
  140 | 			 */
  141 | 			merchantContact: merchantInfo.locator('li.merchantInfo__address'),
  142 |
  143 | 			/**
  144 | 			 * Locate a Navigation Menu item
  145 | 			 */
  146 | 			navItem: (itemName: string) =>
  147 | 				page.locator('li.xNavbar__item', {
  148 | 					hasText: new RegExp(`^${itemName}$`),
  149 | 				}),
  150 | 		};
  151 | 	}
  152 |
  153 | 	/**
  154 | 	 * Wait for a specific API call to be completed
  155 | 	 */
  156 | 	public waitForResponseOfAPI(
  157 | 		api: keyof typeof constants.APIs,
  158 | 		options: TestOptions = {},
  159 | 	) {
  160 | 		return this.page.waitForResponse(
  161 | 			(response) => {
  162 | 				const [method, url] = constants.APIs[api];
  163 | 				const request = response.request();
  164 |
  165 | 				return request.url().includes(url) && request.method() === method;
  166 | 			},
  167 | 			{ timeout: options.timeout },
  168 | 		);
  169 | 	}
  170 |
  171 | 	/**
  172 | 	 * Enter a PIN using the on-screen numpad
  173 | 	 */
  174 | 	public async enterPIN(PIN: string, numpadLocator: Locator) {
  175 | 		for (const pinDigit of PIN) {
  176 | 			const pinDigitButton = numpadLocator.getByText(pinDigit, { exact: true });
  177 | 			await pinDigitButton.click();
  178 | 		}
  179 | 	}
  180 |
  181 | 	/* -------------------------------- BDD steps ------------------------------- */
  182 |
  183 | 	/**
  184 | 	 * Go to a specific page by its {@link PageId}
  185 | 	 */
  186 | 	@Given('I am on the {pageId} page')
  187 | 	public async gotoPage(pageId: PageId) {
  188 | 		await this.page.goto(constants.PageUrl[pageId]);
  189 | 	}
  190 |
  191 | 	/**
  192 | 	 * Wait for the page fully loaded
  193 | 	 */
  194 | 	@When('I wait for the page fully loaded')
  195 | 	public waitForNetworkIdle() {
  196 | 		return this.page.waitForLoadState('networkidle');
  197 | 	}
  198 |
  199 | 	/**
  200 | 	 * Select an item in the Navigation Bar
  201 | 	 *
  202 | 	 * @param navPath - The path to the navigation item, could be a single item or a path to a nested item, separated by " > ".
  203 | 	 *   For example: "Quick Sale", "Timesheet > Clock In", "Timesheet > Clock Out"
  204 | 	 */
  205 | 	@When('I navigate to {string} on the navigation bar')
  206 | 	public async selectNavItem(navPath: string) {
  207 | 		const { locators } = this;
  208 |
  209 | 		// wait for the menu bar ready
  210 | 		await this.waitForNetworkIdle();
  211 |
  212 | 		const navItems = navPath.split(' > ');
  213 | 		for (const navItem of navItems) {
> 214 | 			await locators.navItem(navItem).click();
      | 			                                ^ Error: locator.click: Test timeout of 90000ms exceeded.
  215 | 		}
  216 | 	}
  217 |
  218 | 	/**
  219 | 	 * Click on an element inside the content section of the opening dialog
  220 | 	 */
  221 | 	@When(
  222 | 		'I click on the {string} text inside the content section of the opening dialog',
  223 | 	)
  224 | 	public async clickOnContentElementInsideOpeningDialog(text: string) {
  225 | 		const { locators } = this;
  226 |
  227 | 		const dialog = locators.dialog();
  228 | 		const dialogContent = locators.dialogContent(dialog);
  229 |
  230 | 		await dialogContent.getByText(text, { exact: true }).click();
  231 | 	}
  232 |
  233 | 	/**
  234 | 	 * Click on Action Buttons of the opening dialog, ex: "CONFIRM", "CANCEL",...
  235 | 	 */
  236 | 	@When('I click on the action button {string} of the opening dialog')
  237 | 	public async clickOnActionButtonOfOpeningDialog(buttonText: string) {
  238 | 		const { locators } = this;
  239 |
  240 | 		const dialog = locators.dialog();
  241 | 		const actionButton = locators.dialogActionButton(dialog, buttonText);
  242 |
  243 | 		await actionButton.click();
  244 | 	}
  245 |
  246 | 	/**
  247 | 	 * Close the opening dialog if it's visible
  248 | 	 */
  249 | 	@When('I close the opening dialog')
  250 | 	public async closeOpeningDialog() {
  251 | 		const { locators } = this;
  252 |
  253 | 		const dialog = locators.dialog();
  254 | 		const closeButton = locators.dialogCloseButton(dialog);
  255 |
  256 | 		await closeButton.click();
  257 | 	}
  258 |
  259 | 	/**
  260 | 	 * Clock In/Out Timesheet with provided PIN
  261 | 	 */
  262 | 	@When('I clock {timesheetAction} the timesheet with PIN {string}')
  263 | 	public async clockInTimesheet(timesheetAction: TimesheetAction, PIN: string) {
  264 | 		const { locators } = this;
  265 |
  266 | 		// find and click on the Clock In / Out button
  267 | 		const clockInOutNavigationPath =
  268 | 			timesheetAction === 'in'
  269 | 				? 'Timesheet > Clock In'
  270 | 				: 'Timesheet > Clock Out';
  271 | 		await this.selectNavItem(clockInOutNavigationPath);
  272 |
  273 | 		// expect the enter password dialog to be visible
  274 | 		const enterPasswordDialog = locators.dialog('PASSWORD');
  275 | 		await expect(enterPasswordDialog).toBeVisible();
  276 |
  277 | 		// enter the PIN
  278 | 		await this.enterPIN(PIN, enterPasswordDialog);
  279 |
  280 | 		// click confirm action button
  281 | 		await this.clickOnActionButtonOfOpeningDialog('CONFIRM');
  282 |
  283 | 		const successfullyClockedInToast = locators.toast.getByText(
  284 | 			'clocked in successfully',
  285 | 		); // in case of new session
  286 | 		const alreadyClockedInToast = locators.toast.getByText('has clocked in'); // in case there's an existing session
  287 |
  288 | 		// expect a toast message indicating the result of the operation
  289 | 		await expect(
  290 | 			successfullyClockedInToast.or(alreadyClockedInToast),
  291 | 		).toBeVisible();
  292 |
  293 | 		// if the dialog is still visible, close it
  294 | 		if (await enterPasswordDialog.isVisible()) await this.closeOpeningDialog();
  295 | 	}
  296 | }
  297 |
```